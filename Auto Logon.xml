<sequence version="3.10"><group name="Auto Logon" description=""><step type="SMS_TaskSequence_RunCommandLineAction" name="Create Auto Logon Account" description="Creates local account to auto logon. HWPASSWORD variable stores the password for account. Define via Collection variables." runIn="WinPEandFullOS" successCodeList="0 3010" retryCount="0" runFromNet="false"><action>smsswd.exe /run: net user hwinst %HWPASSWORD% /add</action><defaultVarList><variable name="CommandLine" property="CommandLine" hidden="true">net user hwinst %HWPASSWORD% /add</variable><variable name="SMSTSDisableWow64Redirection" property="DisableWow64Redirection">false</variable><variable name="_SMSTSRunCommandLineAsUser" property="RunAsUser">false</variable><variable name="SuccessCodes" property="SuccessCodes" hidden="true">0 3010</variable></defaultVarList></step><step type="SMS_TaskSequence_RunCommandLineAction" name="Add Auto Logon Account To Administrators" description="Adds the local account just created to the Administrators group" runIn="WinPEandFullOS" successCodeList="0 3010" retryCount="0" runFromNet="false"><action>smsswd.exe /run: net localgroup Administrators hwinst /add</action><defaultVarList><variable name="CommandLine" property="CommandLine" hidden="true">net localgroup Administrators hwinst /add</variable><variable name="SMSTSDisableWow64Redirection" property="DisableWow64Redirection">false</variable><variable name="_SMSTSRunCommandLineAsUser" property="RunAsUser">false</variable><variable name="SuccessCodes" property="SuccessCodes" hidden="true">0 3010</variable></defaultVarList></step><step type="SMS_TaskSequence_RunCommandLineAction" name="Set Default User Name" description="Adds the username for the newly created account to the auto logon registry key" runIn="WinPEandFullOS" successCodeList="0 3010" retryCount="0" runFromNet="false"><action>smsswd.exe /run: reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v DefaultUserName /t REG_SZ /d "%computername%\hwinst" /f</action><defaultVarList><variable name="CommandLine" property="CommandLine" hidden="true">reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v DefaultUserName /t REG_SZ /d "%computername%\hwinst" /f</variable><variable name="SMSTSDisableWow64Redirection" property="DisableWow64Redirection">true</variable><variable name="_SMSTSRunCommandLineAsUser" property="RunAsUser">false</variable><variable name="SuccessCodes" property="SuccessCodes" hidden="true">0 3010</variable></defaultVarList></step><step type="SMS_TaskSequence_RunCommandLineAction" name="Set Default Password" description="Adds the password for the newly created account to the auto logon registry key via the HWPASSWORD variable" runIn="WinPEandFullOS" successCodeList="0 3010" retryCount="0" runFromNet="false"><action>smsswd.exe /run: reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v DefaultPassword /t REG_SZ /d "%HWPASSWORD%" /f</action><defaultVarList><variable name="CommandLine" property="CommandLine" hidden="true">reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v DefaultPassword /t REG_SZ /d "%HWPASSWORD%" /f</variable><variable name="SMSTSDisableWow64Redirection" property="DisableWow64Redirection">true</variable><variable name="_SMSTSRunCommandLineAsUser" property="RunAsUser">false</variable><variable name="SuccessCodes" property="SuccessCodes" hidden="true">0 3010</variable></defaultVarList></step><step type="SMS_TaskSequence_RunCommandLineAction" name="Set Auto Admin Logon" description="Sets the PC to auto logon" runIn="WinPEandFullOS" successCodeList="0 3010" retryCount="0" runFromNet="false"><action>smsswd.exe /run: reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v AutoAdminLogon /t REG_SZ /d 1 /f</action><defaultVarList><variable name="CommandLine" property="CommandLine" hidden="true">reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v AutoAdminLogon /t REG_SZ /d 1 /f</variable><variable name="SMSTSDisableWow64Redirection" property="DisableWow64Redirection">true</variable><variable name="_SMSTSRunCommandLineAsUser" property="RunAsUser">false</variable><variable name="SuccessCodes" property="SuccessCodes" hidden="true">0 3010</variable></defaultVarList></step><step type="SMS_TaskSequence_RunCommandLineAction" name="Set Auto Logon Count" description="Sets the PC to only auto logon once" runIn="WinPEandFullOS" successCodeList="0 3010" retryCount="0" runFromNet="false"><action>smsswd.exe /run: reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v AutoLogonCount /t REG_DWORD /d 1 /f</action><defaultVarList><variable name="CommandLine" property="CommandLine" hidden="true">reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v AutoLogonCount /t REG_DWORD /d 1 /f</variable><variable name="SMSTSDisableWow64Redirection" property="DisableWow64Redirection">true</variable><variable name="_SMSTSRunCommandLineAsUser" property="RunAsUser">false</variable><variable name="SuccessCodes" property="SuccessCodes" hidden="true">0 3010</variable></defaultVarList></step><step type="SMS_TaskSequence_RunCommandLineAction" name="Delete Legal Notice Caption" description="Deletes Legal Notice that prevents the PC from auto logging in. Enable if Legal Notice exists." disable="true" runIn="WinPEandFullOS" successCodeList="0 3010" retryCount="0" runFromNet="false"><action>smsswd.exe /run: reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v LegalNoticeCaption /f</action><defaultVarList><variable name="CommandLine" property="CommandLine" hidden="true">reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v LegalNoticeCaption /f</variable><variable name="SMSTSDisableWow64Redirection" property="DisableWow64Redirection">true</variable><variable name="_SMSTSRunCommandLineAsUser" property="RunAsUser">false</variable><variable name="SuccessCodes" property="SuccessCodes" hidden="true">0 3010</variable></defaultVarList></step><step type="SMS_TaskSequence_RunCommandLineAction" name="RunOnce - Restart After Auto Logon" description="Adds a RunOnce registry key that restarts the computer 45 seconds after auto logon. If necessary change time value as needed" runIn="WinPEandFullOS" successCodeList="0 3010" retryCount="0" runFromNet="false"><action>smsswd.exe /run: reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce" /v Restart /t REG_SZ /d "shutdown.exe /f /r /t 45" /f</action><defaultVarList><variable name="CommandLine" property="CommandLine" hidden="true">reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce" /v Restart /t REG_SZ /d "shutdown.exe /f /r /t 45" /f</variable><variable name="SMSTSDisableWow64Redirection" property="DisableWow64Redirection">true</variable><variable name="_SMSTSRunCommandLineAsUser" property="RunAsUser">false</variable><variable name="SuccessCodes" property="SuccessCodes" hidden="true">0 3010</variable></defaultVarList></step><step type="SMS_TaskSequence_RunCommandLineAction" name="RunOnce - Delete HW Install Account" description="Adds a RunOnce registry key that deletes the local admin account after its initial use just in case it is compromised" runIn="WinPEandFullOS" successCodeList="0 3010" retryCount="0" runFromNet="false"><action>smsswd.exe /run: reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce" /v DelHWInstAcct /t REG_SZ /d "net user hwinst /delete" /f</action><defaultVarList><variable name="CommandLine" property="CommandLine" hidden="true">reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce" /v DelHWInstAcct /t REG_SZ /d "net user hwinst /delete" /f</variable><variable name="SMSTSDisableWow64Redirection" property="DisableWow64Redirection">true</variable><variable name="_SMSTSRunCommandLineAsUser" property="RunAsUser">false</variable><variable name="SuccessCodes" property="SuccessCodes" hidden="true">0 3010</variable></defaultVarList></step><step type="SMS_TaskSequence_RunCommandLineAction" name="RunOnce - Delete Default User Name" description="Adds a RunOnce registry key that deletes the Default User Name that is left behind when Auto Logon is used" runIn="WinPEandFullOS" successCodeList="0 3010" retryCount="0" runFromNet="false"><action>smsswd.exe /run: reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce" /v DelDefaultUser /t REG_SZ /d "reg delete \"HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\" /v DefaultUserName /f" /f</action><defaultVarList><variable name="CommandLine" property="CommandLine" hidden="true">reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce" /v DelDefaultUser /t REG_SZ /d "reg delete \"HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\" /v DefaultUserName /f" /f</variable><variable name="SMSTSDisableWow64Redirection" property="DisableWow64Redirection">true</variable><variable name="_SMSTSRunCommandLineAsUser" property="RunAsUser">false</variable><variable name="SuccessCodes" property="SuccessCodes" hidden="true">0 3010</variable></defaultVarList></step><step type="SMS_TaskSequence_RunCommandLineAction" name="RunOnce - Add Legal Notice Caption" description="Adds the Legal Notice back  when the PC has finished auto logging in. Enable if Legal Notice exists." disable="true" runIn="WinPEandFullOS" successCodeList="0 3010" retryCount="0" runFromNet="false"><action>smsswd.exe /run: reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce" /v AddLegalNoticeCaption /t REG_SZ /d "reg add \"HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\" /v LegalNoticeCaption /t REG_SZ /d \"Add Legal Notice Caption Here\" /f" /f</action><defaultVarList><variable name="CommandLine" property="CommandLine" hidden="true">reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce" /v AddLegalNoticeCaption /t REG_SZ /d "reg add \"HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\" /v LegalNoticeCaption /t REG_SZ /d \"Add Legal Notice Caption Here\" /f" /f</variable><variable name="SMSTSDisableWow64Redirection" property="DisableWow64Redirection">true</variable><variable name="_SMSTSRunCommandLineAsUser" property="RunAsUser">false</variable><variable name="SuccessCodes" property="SuccessCodes" hidden="true">0 3010</variable></defaultVarList></step></group></sequence>
